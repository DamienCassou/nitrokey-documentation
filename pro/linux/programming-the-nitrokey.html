<!DOCTYPE html>
<html lang="English">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Programming the Nitrokey | Nitrokey Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="User documentation of all Nitrokey products">
    <link rel="preload" href="/assets/css/11.styles.7a9d4aaa.css" as="style"><link rel="preload" href="/assets/js/app.845aacf4.js" as="script"><link rel="preload" href="/assets/js/34.528933c8.js" as="script"><link rel="preload" href="/assets/js/3.ed990060.js" as="script"><link rel="prefetch" href="/assets/js/0.c00a7de0.js"><link rel="prefetch" href="/assets/js/1.cf7fbedd.js"><link rel="prefetch" href="/assets/js/10.6140a4b2.js"><link rel="prefetch" href="/assets/js/12.a60bf21c.js"><link rel="prefetch" href="/assets/js/13.23373936.js"><link rel="prefetch" href="/assets/js/14.07550ef6.js"><link rel="prefetch" href="/assets/js/15.f9029697.js"><link rel="prefetch" href="/assets/js/16.05fe6cfa.js"><link rel="prefetch" href="/assets/js/17.72a72bf3.js"><link rel="prefetch" href="/assets/js/18.3149f9d3.js"><link rel="prefetch" href="/assets/js/19.94e8ddc9.js"><link rel="prefetch" href="/assets/js/2.2e76354e.js"><link rel="prefetch" href="/assets/js/20.adfe4e48.js"><link rel="prefetch" href="/assets/js/21.ccea658b.js"><link rel="prefetch" href="/assets/js/22.ad55eacd.js"><link rel="prefetch" href="/assets/js/23.12f6b13c.js"><link rel="prefetch" href="/assets/js/24.c16c0c48.js"><link rel="prefetch" href="/assets/js/25.22544f77.js"><link rel="prefetch" href="/assets/js/26.674d51d6.js"><link rel="prefetch" href="/assets/js/27.471b5612.js"><link rel="prefetch" href="/assets/js/28.8a21532c.js"><link rel="prefetch" href="/assets/js/29.3db1bdeb.js"><link rel="prefetch" href="/assets/js/30.a5e3cf5c.js"><link rel="prefetch" href="/assets/js/31.5c4bb120.js"><link rel="prefetch" href="/assets/js/32.6c18ef66.js"><link rel="prefetch" href="/assets/js/35.567e9ffc.js"><link rel="prefetch" href="/assets/js/36.53762f7e.js"><link rel="prefetch" href="/assets/js/37.e521cc6a.js"><link rel="prefetch" href="/assets/js/38.6a4f5014.js"><link rel="prefetch" href="/assets/js/39.ad7d326b.js"><link rel="prefetch" href="/assets/js/4.a0197a58.js"><link rel="prefetch" href="/assets/js/40.5d88c85f.js"><link rel="prefetch" href="/assets/js/41.56f5adb5.js"><link rel="prefetch" href="/assets/js/42.0163a873.js"><link rel="prefetch" href="/assets/js/43.7006e2bd.js"><link rel="prefetch" href="/assets/js/44.8694b5d0.js"><link rel="prefetch" href="/assets/js/45.a90bd3d9.js"><link rel="prefetch" href="/assets/js/46.1c194260.js"><link rel="prefetch" href="/assets/js/47.6af8bdb8.js"><link rel="prefetch" href="/assets/js/48.2a428fbe.js"><link rel="prefetch" href="/assets/js/49.385f0c01.js"><link rel="prefetch" href="/assets/js/5.f8fe19c6.js"><link rel="prefetch" href="/assets/js/50.732fd160.js"><link rel="prefetch" href="/assets/js/51.fa089968.js"><link rel="prefetch" href="/assets/js/52.8df86cdf.js"><link rel="prefetch" href="/assets/js/53.ff3f165f.js"><link rel="prefetch" href="/assets/js/54.a5b40fe2.js"><link rel="prefetch" href="/assets/js/55.9011e546.js"><link rel="prefetch" href="/assets/js/56.603af26a.js"><link rel="prefetch" href="/assets/js/57.a1283968.js"><link rel="prefetch" href="/assets/js/58.fa2060f7.js"><link rel="prefetch" href="/assets/js/59.9e7360e5.js"><link rel="prefetch" href="/assets/js/6.0b49426c.js"><link rel="prefetch" href="/assets/js/60.fccc7f35.js"><link rel="prefetch" href="/assets/js/61.51c90890.js"><link rel="prefetch" href="/assets/js/62.1f8f3715.js"><link rel="prefetch" href="/assets/js/63.972ede00.js"><link rel="prefetch" href="/assets/js/64.b8bdbad4.js"><link rel="prefetch" href="/assets/js/65.cea07894.js"><link rel="prefetch" href="/assets/js/66.33cb39ab.js"><link rel="prefetch" href="/assets/js/67.48cbac1c.js"><link rel="prefetch" href="/assets/js/68.fd4f76b0.js"><link rel="prefetch" href="/assets/js/69.6b6977b4.js"><link rel="prefetch" href="/assets/js/7.efa64cfd.js"><link rel="prefetch" href="/assets/js/70.57335725.js"><link rel="prefetch" href="/assets/js/71.9ac173a5.js"><link rel="prefetch" href="/assets/js/72.58f6f498.js"><link rel="prefetch" href="/assets/js/73.1dc4439f.js"><link rel="prefetch" href="/assets/js/74.e76de27b.js"><link rel="prefetch" href="/assets/js/75.deeaccfd.js"><link rel="prefetch" href="/assets/js/76.317efd4f.js"><link rel="prefetch" href="/assets/js/77.476ca752.js"><link rel="prefetch" href="/assets/js/78.f27cc770.js"><link rel="prefetch" href="/assets/js/79.52a58dc9.js"><link rel="prefetch" href="/assets/js/8.35892e8e.js"><link rel="prefetch" href="/assets/js/80.04cce149.js"><link rel="prefetch" href="/assets/js/81.4ab0ee85.js"><link rel="prefetch" href="/assets/js/82.f4199226.js"><link rel="prefetch" href="/assets/js/9.bbf2b4b7.js">
    <link rel="stylesheet" href="/assets/css/11.styles.7a9d4aaa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/nitrokey_logo_nur_schild_rot.svg" alt="Nitrokey Documentation" class="logo"> <span class="site-name can-hide">Nitrokey Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Product Menu" class="dropdown-title"><span class="title">Products</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fido2/" class="nav-link">
  Nitrokey FIDO2
</a></li><li class="dropdown-item"><!----> <a href="/u2f/" class="nav-link">
  Nitrokey FIDO U2F
</a></li><li class="dropdown-item"><!----> <a href="/hsm/" class="nav-link">
  Nitrokey HSM
</a></li><li class="dropdown-item"><!----> <a href="/pro/" class="nav-link router-link-active">
  Nitrokey Pro
</a></li><li class="dropdown-item"><!----> <a href="/start/" class="nav-link">
  Nitrokey Start
</a></li><li class="dropdown-item"><!----> <a href="/storage/" class="nav-link">
  Nitrokey Storage
</a></li><li class="dropdown-item"><!----> <a href="/x230/" class="nav-link">
  NitroPad X230
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pro/linux/programming-the-nitrokey.html" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/de/" class="nav-link">
  Deutsch
</a></li></ul></div></div> <a href="https://github.com/Nitrokey/nitrokey-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Product Menu" class="dropdown-title"><span class="title">Products</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fido2/" class="nav-link">
  Nitrokey FIDO2
</a></li><li class="dropdown-item"><!----> <a href="/u2f/" class="nav-link">
  Nitrokey FIDO U2F
</a></li><li class="dropdown-item"><!----> <a href="/hsm/" class="nav-link">
  Nitrokey HSM
</a></li><li class="dropdown-item"><!----> <a href="/pro/" class="nav-link router-link-active">
  Nitrokey Pro
</a></li><li class="dropdown-item"><!----> <a href="/start/" class="nav-link">
  Nitrokey Start
</a></li><li class="dropdown-item"><!----> <a href="/storage/" class="nav-link">
  Nitrokey Storage
</a></li><li class="dropdown-item"><!----> <a href="/x230/" class="nav-link">
  NitroPad X230
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pro/linux/programming-the-nitrokey.html" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/de/" class="nav-link">
  Deutsch
</a></li></ul></div></div> <a href="https://github.com/Nitrokey/nitrokey-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/pro/linux/" class="sidebar-link">Nitrokey Pro 2, Linux</a></li><li><a href="/pro/linux/2fa-nextcloud.html" class="sidebar-link">Two-factor Authentication for Nextcloud accounts</a></li><li><a href="/pro/linux/openpgp-email-encryption-with-thunderbird.html" class="sidebar-link">OpenPGP Email Encryption With Thunderbird</a></li><li><a href="/pro/linux/openpgp-key-generation-on-device.html" class="sidebar-link">OpenPGP Key Generation On-Device</a></li><li><a href="/pro/linux/openpgp-key-generation-with-backup.html" class="sidebar-link">OpenPGP Key Generation With Backup</a></li><li><a href="/pro/linux/openpgp-key-generation-using-gpa.html" class="sidebar-link">OpenPGP Key Generation Using GPA</a></li><li><a href="/pro/linux/smime-email-encryption-with-thunderbird.html" class="sidebar-link">S/MIME Email Encryption with Thunderbird</a></li><li><a href="/pro/linux/login-with-eidauthenticate-on-stand-alone-windows-computers.html" class="sidebar-link">Login With EIDAuthenticate on Stand Alone Windows Computers</a></li><li><a href="/pro/linux/programming-the-nitrokey.html" class="active sidebar-link">Programming the Nitrokey</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pro/linux/programming-the-nitrokey.html#flashing-the-nitrokey-pro" class="sidebar-link">Flashing the Nitrokey Pro</a></li></ul></li><li><a href="/pro/linux/login-to-windows-domain-computers-with-ms-active-directory.html" class="sidebar-link">Login to Windows Domain Computers With MS Active Directory</a></li><li><a href="/pro/linux/two-factor-authentication-with-otp.html" class="sidebar-link">Two-factor Authentication with One-Time Passwords (OTP)</a></li><li><a href="/pro/linux/two-factor-authentication-for-google.html" class="sidebar-link">Two-factor Authentication for Google</a></li><li><a href="/pro/linux/elliptic-curves-ecc-support.html" class="sidebar-link">Elliptic Curves (ECC) Support</a></li><li><a href="/pro/linux/putty.html" class="sidebar-link">PuTTY</a></li><li><a href="/pro/linux/two-factor-authentication-for-erp-software-odoo.html" class="sidebar-link">Two-factor authentication for ERP software Odoo</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="programming-the-nitrokey"><a href="#programming-the-nitrokey" class="header-anchor">#</a> Programming the Nitrokey</h1> <p>Nitrokey Pro, Start and HSM use the same hardware but different firmwares and different smart cards. The microprocessor being used is a <a href="http://www.st.com/internet/mcu/product/164488.jsp" target="_blank" rel="noopener noreferrer">STM32F103R8T6<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The firmware is written in C, the desktop software Nitrokey App is written in C/C++. You find all software sources and hardware layouts at <a href="https://github.com/nitrokey" target="_blank" rel="noopener noreferrer">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>To develop the firmware of the Nitrokey Pro/Start/HSM you would need:</p> <ul><li><p>An original Nitrokey Pro/Start/HSM or better a development board such as the <a href="https://www.olimex.com/Products/ARM/ST/STM32-H103/" target="_blank" rel="noopener noreferrer">Olimex STM32-H103<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Alternatively, get any other development board equipped with a STM32F103TB and 128KB flash. On request you can get a Nitrokey for development purposes from us.</p></li> <li><p>An <a href="https://www.assembla.com/wiki/show/cryptostick/OpenPGP" target="_blank" rel="noopener noreferrer">OpenPGP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Card 2.1 available at <a href="http://shop.kernelconcepts.de/" target="_blank" rel="noopener noreferrer">Kernel Concepts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or on request from us. (Of course, this is not necessary for Nitrokey Start which doesn't contain a smart card.)
If you use it with original Nitrokey hardware, you would need to cut it to Micro-SIM size. This can be done by using a special SIM card cutter or even with a scissor.
If you use a development board, you may solder the OpenPGP Card to the board directly by using some wires or you get yourself a smart card jack which you solder to the dev board instead.</p></li> <li><p>To compile the firmware we recommend <a href="https://launchpad.net/gcc-arm-embedded/" target="_blank" rel="noopener noreferrer">ARM's official GNU tools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></li> <li><p>The microprocessor can be flashed with two different approaches:</p> <ol><li>SWD is a STM-specific protocol and similar to JTAG allowing programming and debugging. Working adapters are Versaloon or any of the <a href="http://www.ebay.com/sch/i.html?_odkw=st-link&amp;_osacat=0&amp;_from=R40&amp;_trksid=p2045573.m570.l1313.TR0.TRC0.H0.Xst-link+v2&amp;_nkw=st-link+v2&amp;_sacat=0" target="_blank" rel="noopener noreferrer">ST-Link V2 (clones)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Under Linux you could use OpenOCD or official STM32 flashing tool (commands below). This approach requires to solder wires to the contact pads or to use an <a href="https://github.com/Nitrokey/nitrokey-pro-hardware/tree/master/cs_pogo_adapter" target="_blank" rel="noopener noreferrer">adapter with pogo pins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and some kind of mounting (recommended).</li></ol> <p><img src="/assets/img/1.378e1eb8.png" alt="img1"></p> <ol start="2"><li>DFU is a simple protocol via serial port which allows programming but no debugging. On the Nitrokey hardware we expose the appropriate pins over the USB connector but it's not USB! Details are described in the next chapter.</li></ol></li></ul> <h2 id="flashing-the-nitrokey-pro"><a href="#flashing-the-nitrokey-pro" class="header-anchor">#</a> Flashing the Nitrokey Pro</h2> <p>Further information about flashing the device can be found at the <a href="https://github.com/Nitrokey/nitrokey-pro-firmware" target="_blank" rel="noopener noreferrer">Github repository of the Nitrokey Pro<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="flashing-commands-cheatsheet"><a href="#flashing-commands-cheatsheet" class="header-anchor">#</a> Flashing commands cheatsheet</h3> <p>You can use either OpenOCD package native to your OS, or STM's <code>STM32_Programmer_CLI</code> tool from the <a href="https://www.st.com/en/development-tools/stm32cubeprog.html" target="_blank" rel="noopener noreferrer">STM32CubeProgrammer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> package. No need to build the OpenOCD by hand with the latest Linux distributions.</p> <p>STM32 programmer:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">FW</span><span class="token operator">=</span>firmware.bin
<span class="token comment"># erase</span>
STM32_Programmer_CLI -c <span class="token assign-left variable">port</span><span class="token operator">=</span>SWD -halt -e all --readunprotect
<span class="token comment"># flash</span>
STM32_Programmer_CLI -c <span class="token assign-left variable">port</span><span class="token operator">=</span>SWD -halt  -d <span class="token variable">${FW}</span> -rst
<span class="token comment"># STM32 programmer cannot set read protection; alternatively can be set with </span>
<span class="token comment"># running the update through bootloader, or using OpenOCD</span>
</code></pre></div><p>OpenOCD:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">FW</span><span class="token operator">=</span>firmware.bin
<span class="token comment"># erase</span>
openocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c <span class="token string">&quot;init&quot;</span> -c <span class="token string">&quot;reset halt&quot;</span> -c <span class="token string">&quot;stm32f1x mass_erase 0&quot;</span> -c <span class="token string">&quot;exit&quot;</span>
<span class="token comment"># flash</span>
openocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c <span class="token string">&quot;init&quot;</span> -c <span class="token string">&quot;reset halt&quot;</span> -c <span class="token string">&quot;stm32f1x unlock 0&quot;</span> -c <span class="token string">&quot;reset halt&quot;</span> -c <span class="token string">&quot;flash write_image erase <span class="token variable">${FW}</span>&quot;</span> -c <span class="token string">&quot;reset run&quot;</span> -c <span class="token string">&quot;exit&quot;</span>
<span class="token comment"># set read-protection </span>
openocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c <span class="token string">&quot;init&quot;</span> -c <span class="token string">&quot;reset halt&quot;</span> -c <span class="token string">&quot;stm32f1x lock 0&quot;</span> -c <span class="token string">&quot;reset run&quot;</span> -c <span class="token string">&quot;exit&quot;</span>
</code></pre></div><p>Latest firmware (only <code>gnuk.hex</code> is needed - please use it for flashing):</p> <ul><li>https://github.com/Nitrokey/nitrokey-start-firmware/tree/gnuk1.2-regnual-fix/prebuilt/RTM.10</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Nitrokey/nitrokey-documentation/edit/master/pro/linux/programming-the-nitrokey.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/14/2020, 1:04:49 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pro/linux/login-with-eidauthenticate-on-stand-alone-windows-computers.html" class="prev">
        Login With EIDAuthenticate on Stand Alone Windows Computers
      </a></span> <span class="next"><a href="/pro/linux/login-to-windows-domain-computers-with-ms-active-directory.html">
        Login to Windows Domain Computers With MS Active Directory
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.845aacf4.js" defer></script><script src="/assets/js/34.528933c8.js" defer></script><script src="/assets/js/3.ed990060.js" defer></script>
  </body>
</html>
