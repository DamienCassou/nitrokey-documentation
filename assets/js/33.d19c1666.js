(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{327:function(e,t,a){e.exports=a.p+"assets/img/fidou2f-1.572ee8e9.png"},328:function(e,t,a){e.exports=a.p+"assets/img/fidou2f-2.832e0b43.png"},329:function(e,t,a){e.exports=a.p+"assets/img/fidou2f-4.fb7f9439.png"},330:function(e,t,a){e.exports=a.p+"assets/img/fidou2f-5.e6f3421c.png"},331:function(e,t,a){e.exports=a.p+"assets/img/u2f-fido-pam-2.c739d7d3.png"},524:function(e,t,a){"use strict";a.r(t);var o=a(33),s=Object(o.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"desktop-login-and-linux-user-authentication"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#desktop-login-and-linux-user-authentication"}},[e._v("#")]),e._v(" Desktop Login and Linux User Authentication")]),e._v(" "),o("h2",{attrs:{id:"introduction"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[e._v("#")]),e._v(" Introduction")]),e._v(" "),o("p",[e._v("This guide will walk you through the configuration of Linux to use FIDO Universal 2nd Factor, i.e. FIDO U2F with "),o("code",[e._v("libpam-u2f")]),e._v(" and "),o("a",{attrs:{href:"https://shop.nitrokey.com/shop/product/nk-fi2-nitrokey-fido2-55",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nitrokey FIDO2"),o("OutboundLink")],1),e._v(" .")]),e._v(" "),o("p",[e._v("If you want to login to you computer using "),o("a",{attrs:{href:"https://shop.nitrokey.com/shop/product/nk-pro-2-nitrokey-pro-2-3",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nitrokey Pro 2,"),o("OutboundLink")],1),e._v(" "),o("a",{attrs:{href:"https://shop.nitrokey.com/shop/product/nitrokey-storage-2-56",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nitrokey Storage 2"),o("OutboundLink")],1),e._v(" and "),o("a",{attrs:{href:"https://shop.nitrokey.com/shop/product/nk-sta-nitrokey-start-6",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nitrokey Start"),o("OutboundLink")],1),e._v(" you can visit the instructions for Windows available "),o("a",{attrs:{href:"https://www.nitrokey.com/documentation/applications#computer-login",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),o("OutboundLink")],1),e._v(", and for Linux "),o("a",{attrs:{href:"https://www.nitrokey.com/documentation/applications#computer-login",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),o("OutboundLink")],1),e._v(" .")]),e._v(" "),o("h3",{attrs:{id:"requirements"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),o("ul",[o("li",[e._v("Ubuntu 20.04 with Gnome Display Manager.")]),e._v(" "),o("li",[e._v("Nitrokey FIDO2 configured following "),o("a",{attrs:{href:"https://www.nitrokey.com/documentation/installation#p:nitrokey-fido-u2f&os:linux",target:"_blank",rel:"noopener noreferrer"}},[e._v("these instructions"),o("OutboundLink")],1),e._v(".")])]),e._v(" "),o("h2",{attrs:{id:"instructions"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#instructions"}},[e._v("#")]),e._v(" Instructions")]),e._v(" "),o("h3",{attrs:{id:"preparation"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#preparation"}},[e._v("#")]),e._v(" Preparation")]),e._v(" "),o("h4",{attrs:{id:"_1-set-up-backup-user"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_1-set-up-backup-user"}},[e._v("#")]),e._v(" 1. Set up "),o("code",[e._v("<backup_user>")])]),e._v(" "),o("p",[e._v("This step is not necessary for the setup, however it is recommended as fall-back if you are testing user-specific instructions.")]),e._v(" "),o("h5",{attrs:{id:"gui-method"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#gui-method"}},[e._v("#")]),e._v(" GUI method")]),e._v(" "),o("ol",[o("li",[e._v("In the lower left corner click on "),o("code",[e._v("Show Applications")]),e._v(" and type settings in the search bar as following:")])]),e._v(" "),o("p",[o("img",{attrs:{src:a(327),alt:""}})]),e._v(" "),o("ol",{attrs:{start:"2"}},[o("li",[e._v("Scroll down in the right bar to "),o("code",[e._v("Users")])])]),e._v(" "),o("p",[o("img",{attrs:{src:a(328),alt:""}})]),e._v(" "),o("ol",{attrs:{start:"3"}},[o("li",[e._v("In the left corner click on "),o("code",[e._v("Unlock")]),e._v(" and that would prompt for your password")]),e._v(" "),o("li",[e._v("Select "),o("code",[e._v("Administrator")]),e._v(" and enter the user name and password of your choice")])]),e._v(" "),o("p",[o("img",{attrs:{src:a(329),alt:""}})]),e._v(" "),o("ol",{attrs:{start:"5"}},[o("li",[e._v("Once you finish Step 4 you should be done")])]),e._v(" "),o("p",[o("img",{attrs:{src:a(330),alt:""}})]),e._v(" "),o("h5",{attrs:{id:"cli-method"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cli-method"}},[e._v("#")]),e._v(" CLI method")]),e._v(" "),o("p",[e._v("Create a backup user, and give it root privileges with these commands:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" adduser "),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("backup_user"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("usermod")]),e._v(" -aG "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("backup_user"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),o("p",[e._v("In case you prefer to setup U2F for a single user, and are locked out of your user session, you would still be able to login with the "),o("code",[e._v("<backup_user>")]),e._v(", and proceed with the maintenance.")]),e._v(" "),o("div",{staticClass:"custom-block warning"},[o("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),o("p",[e._v("The following guide can potentially lock you out of your computer. You should be aware of these risks, as it is recommended to first use the instructions below on a secondary computer, or after a full backup.")]),e._v(" "),o("p",[e._v("You might lose access to your data after configuring "),o("a",{attrs:{href:"http://www.linux-pam.org/Linux-PAM-html/",target:"_blank",rel:"noopener noreferrer"}},[e._v("PAM modules"),o("OutboundLink")],1),e._v(".")])]),e._v(" "),o("h4",{attrs:{id:"_2-set-up-the-rules-to-recognize-the-nitrokey-fido2"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_2-set-up-the-rules-to-recognize-the-nitrokey-fido2"}},[e._v("#")]),e._v(" 2. Set up the "),o("code",[e._v("rules")]),e._v(" to recognize the Nitrokey FIDO2")]),e._v(" "),o("p",[e._v("Under "),o("code",[e._v("/etc/udev/rules.d")]),e._v(" download "),o("code",[e._v("41-nitrokey.rules")])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /etc/udev/rules.d/\n$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("wget")]),e._v(" https://raw.githubusercontent.com/Nitrokey/libnitrokey/master/data/41-nitrokey.rules\n")])])]),o("p",[e._v("And restart "),o("code",[e._v("udev")]),e._v(" service")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl restart udev\n")])])]),o("h4",{attrs:{id:"_3-install-libpam-u2f"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_3-install-libpam-u2f"}},[e._v("#")]),e._v(" 3. Install "),o("code",[e._v("libpam-u2f")])]),e._v(" "),o("p",[e._v("On Ubuntu 20.04 it is possible to download directly "),o("code",[e._v("ibpam-u2f")]),e._v(" from the official repos")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" libpam-u2f\n")])])]),o("details",{staticClass:"custom-block details"},[o("summary",[e._v("Click for more options")]),e._v(" "),o("ul",[o("li",[e._v("Alternatively you can build "),o("code",[e._v("libpam-u2f")]),e._v(" from "),o("a",{attrs:{href:"https://github.com/phoeagon/pam-u2f",target:"_blank",rel:"noopener noreferrer"}},[e._v("Git"),o("OutboundLink")],1),e._v(".")]),e._v(" "),o("li",[e._v("To verify that the library is properly installed enter the following command:")])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("file")]),e._v(" /lib/x86_64-linux-gnu/security/pam_u2f.so\n")])])]),o("p",[e._v("The Output should be something like the following:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("/lib/x86_64-linux-gnu/security/pam_u2f.so: "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(" ELF "),o("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v("-bit LSB shared object, x86-64, version "),o("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("SYSV"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(","),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(" dynamically linked, BuildID"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("sha1"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("1d55e1b11a97be2038c6a139579f6c0d91caedb1, stripped\n")])])])]),e._v(" "),o("h4",{attrs:{id:"_4-prepare-the-directory"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_4-prepare-the-directory"}},[e._v("#")]),e._v(" 4. Prepare the Directory")]),e._v(" "),o("p",[e._v("Create "),o("code",[e._v(".config/Nitrokey/")]),e._v(" under your home directory")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" ~/.config/Nitrokey\n")])])]),o("p",[e._v("And plug your Nitrokey FIDO2.")]),e._v(" "),o("h3",{attrs:{id:"configuration"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),o("p",[e._v("Once done with the preparation, we can start to configure the computer to use the Nitrokey FIDO2 for 2nd factor authentication at login and "),o("code",[e._v("sudo")]),e._v(".")]),e._v(" "),o("h4",{attrs:{id:"_5-generate-the-u2f-config-file"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_5-generate-the-u2f-config-file"}},[e._v("#")]),e._v(" 5. Generate the U2F config file")]),e._v(" "),o("p",[e._v("To generate the configuration file we will use the "),o("code",[e._v("pamu2fcfg")]),e._v(" utility that comes with the "),o("code",[e._v("libpam-u2f")]),e._v(".\nFor convenience, we will directly write the output of the utility to the "),o("code",[e._v("u2f_keys")]),e._v(" file under "),o("code",[e._v(".config/Nitrokey")]),e._v(".\nFirst plug your Nitrokey FIDO2 (if you did not already), and enter the following command:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ pamu2fcfg "),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" ~/.config/Nitrokey/u2f_keys\n")])])]),o("p",[e._v("Once you run the command above, you will need to touch the key while it flashes. Once done, "),o("code",[e._v("pamu2fcfg")]),e._v(" will append its output the "),o("code",[e._v("u2f_keys")]),e._v(" in the following format:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("username"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(":Zx"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".mw,04"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".0a\n")])])]),o("p",[e._v("Note, the output will be much longer, but sensitive parts have been removed here.\nFor better security, and once the config file generated, we will move the "),o("code",[e._v(".config/Nitrokey")]),e._v(" directory under the "),o("code",[e._v("etc/")]),e._v(" directory with this command:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" ~/.config/Nitrokey /etc\t\n")])])]),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),o("ul",[o("li",[e._v("The file under "),o("code",[e._v(".config/Nitrokey")]),e._v(" must be named "),o("code",[e._v("u2f_keys")])]),e._v(" "),o("li",[e._v("It is recommended to first test the instructions with a single user. For this purpose the previous command takes the "),o("code",[e._v("-u")]),e._v(" option, to specify a user, like in the example below:")])]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ pamu2fcfg -u "),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("username"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" ~/.config/Nitrokey/u2f_keys\n")])])]),o("ul",[o("li",[e._v("For individual user configuration you should point to the home directory in the next step, or not include the "),o("code",[e._v("authfile")]),e._v(" option in the PAM configuration.")])])]),e._v(" "),o("h4",{attrs:{id:"_6-backup"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_6-backup"}},[e._v("#")]),e._v(" 6. Backup")]),e._v(" "),o("p",[e._v("This step is optional, however it is advised to have a backup Nitrokey in the case of loss, theft or destruction of your Nitrokey FIDO.")]),e._v(" "),o("p",[e._v("To set up a backup key, repeat the procedure above, and use "),o("code",[e._v("pamu2fcfg -n")]),e._v(". This will omit the "),o("code",[e._v("<username>")]),e._v(" field, and the output can be appended to the line with your "),o("code",[e._v("<username>")]),e._v(" like this:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("<username>:Zx...mw,04...0a:xB...fw,04...3f\n")])])]),o("h4",{attrs:{id:"_7-modify-the-pluggable-authentication-module-pam"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_7-modify-the-pluggable-authentication-module-pam"}},[e._v("#")]),e._v(" 7. Modify the Pluggable Authentication Module "),o("code",[e._v("PAM")])]),e._v(" "),o("p",[e._v("The final step is configure the PAM module files under "),o("code",[e._v("/etc/pam.d/")]),e._v(".\nIn this guide we will modify the "),o("code",[e._v("common-auth")]),e._v(" file as it handles the authentication settings which are common to all services, but other options are possible.\nYou can modify the file with the following command:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /etc/pam.d\n$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$editor")]),e._v(" common-auth\n")])])]),o("p",[e._v("And add the following lines:")]),e._v(" "),o("div",{staticClass:"language-bash extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[o("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#Nitrokey FIDO2 config ")]),e._v("\nauth\tsufficient pam_u2f.so "),o("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("authfile")]),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/etc/Nitrokey/u2f_keys cue prompt \n")])])]),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),o("ul",[o("li",[e._v("Since we are using Central Authentication Mapping, we need to tell "),o("code",[e._v("pam_u2f")]),e._v(" the location of the file to use with the "),o("code",[e._v("authfile")]),e._v(" option.")]),e._v(" "),o("li",[e._v("If you often forget to insert the key, "),o("code",[e._v("prompt")]),e._v(" option make "),o("code",[e._v("pam_u2f")]),e._v(" print "),o("code",[e._v("Insert your U2F device, then press ENTER.")]),e._v(" and give you a chance to insert the Nitrokey.")]),e._v(" "),o("li",[e._v("If you would like to be prompted to touch the Nitrokey, "),o("code",[e._v("cue")]),e._v(" option will make "),o("code",[e._v("pam_u2f")]),e._v(" print "),o("code",[e._v("Please touch the device.")]),e._v(" message.")])])]),e._v(" "),o("p",[e._v("Once we modified the "),o("code",[e._v("common-auth")]),e._v(", we can save and exit the file.")]),e._v(" "),o("p",[e._v("You can test the configuration by typing "),o("code",[e._v("sudo ls")]),e._v(" in the terminal. You should be prompted the message "),o("code",[e._v("Please touch the device.")]),e._v(" and have a similar output on the terminal:")]),e._v(" "),o("div",{staticClass:"language-bash nitrouser@nitrouser:~$ sudo ls extra-class"},[o("pre",{pre:!0,attrs:{class:"language-bash"}},[o("code",[e._v("$ "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("ls")]),e._v("\n"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("sudo"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" password "),o("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("username"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(": \nPlease "),o("span",{pre:!0,attrs:{class:"token function"}},[e._v("touch")]),e._v(" the device.\n")])])]),o("p",[e._v("You can also test your configuration by logging out of the user session and logging back. A similar screen should be displayed once you you unplug/replug yout Nitrokey FIDO2 and type your password:")]),e._v(" "),o("p",[o("img",{attrs:{src:a(331),alt:""}})]),e._v(" "),o("h2",{attrs:{id:"usage"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[e._v("#")]),e._v(" Usage")]),e._v(" "),o("p",[e._v("After the PAM module modification, you will be able to test your configuration right away, but it is recommended to reboot your computer, and unplug/replug the Nitrokey FIDO2.")]),e._v(" "),o("p",[e._v("Once you have properly tested the instructions in this guide (and set up a backup), it is recommended to use either the "),o("code",[e._v("required")]),e._v(" or the "),o("code",[e._v("requisite")]),e._v(" control flag instead of "),o("code",[e._v("sufficient")]),e._v(".")]),e._v(" "),o("p",[e._v("The flags "),o("code",[e._v("required")]),e._v(" and "),o("code",[e._v("requisite")]),e._v(" provide a tighter access control, and will make the Nitrokey FIDO2 necessary to login, and/or use the configured service.")]),e._v(" "),o("p",[e._v("If you need more information about Control Flags in the "),o("code",[e._v("PAM")]),e._v(" configuration line, you may see the last section of this guide to understand the difference, and the implications of using each of them.")]),e._v(" "),o("h4",{attrs:{id:"pam-modules"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#pam-modules"}},[e._v("#")]),e._v(" PAM modules")]),e._v(" "),o("p",[e._v("There are several PAM modules files that can be modified according to your needs:")]),e._v(" "),o("ul",[o("li",[e._v("By modifying "),o("code",[e._v("/etc/pam.d/common-auth")]),e._v(" file, you will be able to use you Nitrokey FIDO for 2nd factor authentication for graphic login and "),o("code",[e._v("sudo")]),e._v(".\nNote: "),o("code",[e._v("common-auth")]),e._v(" should be modified by adding the additional configuration line at the end of the file.")]),e._v(" "),o("li",[e._v("If you wish to use FIDO U2F authentication solely for Gnome's graphic login, you might prefer to modify the"),o("code",[e._v("/etc/pam.d/gdm-password")])]),e._v(" "),o("li",[e._v("Alternatively you can just modify the "),o("code",[e._v("/etc/pam.d/sudo")]),e._v(" file if you wish to use FIDO U2F when using the "),o("code",[e._v("sudo")]),e._v(" command.")])]),e._v(" "),o("h4",{attrs:{id:"control-flags"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#control-flags"}},[e._v("#")]),e._v(" Control flags")]),e._v(" "),o("p",[e._v("In step 7 we have used the "),o("code",[e._v("sufficient")]),e._v(" control flag to determine the behavior of the PAM module when the Nitrokey is plugged or not. However it is possible to change this behavior by using the following control flags:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("required")]),e._v(": This is the most critical flag. The module result must be successful for authentication to continue. This flag can lock you out of your computer if you do not have access to the Nitrokey.")]),e._v(" "),o("li",[o("code",[e._v("requisite")]),e._v(": Similar to "),o("code",[e._v("required")]),e._v(" however, in the case where a specific module returns a failure, control is directly returned to the application, or to the superior PAM stack. This flag can also lock you out of your computer if you do not have access to the Nitrokey.")]),e._v(" "),o("li",[o("code",[e._v("sufficient")]),e._v(": The module result is ignored if it fails. The "),o("code",[e._v("sufficient")]),e._v(" flag considered to be safe for testing purposes.")]),e._v(" "),o("li",[o("code",[e._v("optional")]),e._v(": The success or failure of this module is only important if it is the only module in the stack associated with this service+type. The "),o("code",[e._v("optional")]),e._v(" flag is considered to be safe to use for testing purposes.")])]),e._v(" "),o("div",{staticClass:"custom-block warning"},[o("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),o("ul",[o("li",[o("p",[e._v("If "),o("code",[e._v("required")]),e._v("  or "),o("code",[e._v("requisite")]),e._v(" is set, the failure of U2F authentication will cause a failure of the overall authentication. Failure will occur when the configured Nitrokey FIDO is not plugged, lost or destroyed.")])]),e._v(" "),o("li",[o("p",[e._v("You will lose access to your computer if you mis-configured the PAM module "),o("em",[e._v("and")]),e._v(" used the "),o("code",[e._v("required")]),e._v(" or "),o("code",[e._v("requisite")]),e._v(" flags.")])]),e._v(" "),o("li",[o("p",[e._v("You will also lose the ability to use "),o("code",[e._v("sudo")]),e._v(" if you set up Central Authentication Mapping "),o("em",[e._v("and")]),e._v(" used the "),o("code",[e._v("required")]),e._v(" or "),o("code",[e._v("requisite")]),e._v(" flags.")])])])])])}),[],!1,null,null,null);t.default=s.exports}}]);