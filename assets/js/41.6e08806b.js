(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{437:function(e,t,o){e.exports=o.p+"assets/img/viscosity-1.4a50ea97.jpg"},438:function(e,t,o){e.exports=o.p+"assets/img/viscosity-2.27b5a9d5.jpg"},439:function(e,t,o){e.exports=o.p+"assets/img/viscosity-3.94f8698c.jpg"},440:function(e,t,o){e.exports=o.p+"assets/img/viscosity-4.5623bb29.jpg"},556:function(e,t,o){"use strict";o.r(t);var r=o(33),n=Object(r.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"viscosity-client-configuration-with-openvpn"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#viscosity-client-configuration-with-openvpn"}},[e._v("#")]),e._v(" Viscosity Client Configuration with OpenVPN")]),e._v(" "),r("p",[e._v("This guide will show to configure "),r("a",{attrs:{href:"https://www.sparklabs.com/viscosity/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Viscosity client"),r("OutboundLink")],1),e._v(" to connect to an OpenVPN instance, using a "),r("a",{attrs:{href:"https://shop.nitrokey.com/shop/product/nk-pro-2-nitrokey-pro-2-3",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nitrokey Pro 2"),r("OutboundLink")],1),e._v(" (or "),r("a",{attrs:{href:"https://shop.nitrokey.com/shop/product/nitrokey-storage-2-56",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nitrokey Storage 2"),r("OutboundLink")],1),e._v("), and "),r("a",{attrs:{href:"https://openvpn.net/community-resources/how-to/#what-is-pkcs11",target:"_blank",rel:"noopener noreferrer"}},[e._v("PKCS#11 authentication"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("h2",{attrs:{id:"prerequisites"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),r("p",[e._v("For this guide, you will need an OpenVPN remote server installed and configured for clients. For the purpose of this document, we have used OpenVPN 2.49 installed on a Debian 10 server.")]),e._v(" "),r("p",[e._v("To read about how to configure OpenVPN to authenticate with Nitrokey Pro, you might consult the following "),r("a",{attrs:{href:"https://docs.nitrokey.com/storage/linux/openvpn-configuration-with-easyrsa.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("documentation"),r("OutboundLink")],1),e._v(", as we will just cover the way to configure the Viscosity client in this guide.")]),e._v(" "),r("p",[e._v("You will also need the following:")]),e._v(" "),r("ul",[r("li",[e._v("A Nitrokey Pro 2 or Nitrokey Storage 2")]),e._v(" "),r("li",[e._v("Client's private key "),r("code",[e._v("client.key")]),e._v(" loaded on the Nitrokey")]),e._v(" "),r("li",[e._v("Client's certificate "),r("code",[e._v("client.crt")]),e._v(" loaded on the Nitrokey")]),e._v(" "),r("li",[e._v("The Certificate Authority file, i.e. "),r("code",[e._v("CA.crt")]),e._v(" file used for your OpenVPN setup")]),e._v(" "),r("li",[e._v("Optional: The shared secret key file, i.e. "),r("code",[e._v("ta.key")])])]),e._v(" "),r("p",[e._v("For more information on "),r("code",[e._v("PKCS#11")]),e._v(" key management with OpenVPN, please consult OpenVPN's "),r("a",{attrs:{href:"https://openvpn.net/community-resources/how-to/",target:"_blank",rel:"noopener noreferrer"}},[e._v("documentation."),r("OutboundLink")],1)]),e._v(" "),r("h2",{attrs:{id:"usage"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[e._v("#")]),e._v(" Usage")]),e._v(" "),r("ol",[r("li",[e._v('Start Viscosity and create a new connection "openVPN" (you can name it as you wish)')])]),e._v(" "),r("p",[r("img",{attrs:{src:o(437),alt:""}})]),e._v(" "),r("ol",{attrs:{start:"2"}},[r("li",[e._v("Right click on the connection and click edit")])]),e._v(" "),r("p",[r("img",{attrs:{src:o(438),alt:""}})]),e._v(" "),r("ol",{attrs:{start:"3"}},[r("li",[r("p",[e._v("Add your server's IP address and configure the port according to your configuration.")])]),e._v(" "),r("li",[r("p",[e._v("Under authentication, In "),r("code",[e._v("Type")]),e._v(" scroll down to "),r("code",[e._v("SSL/TLS Client (PKCS11)")])])]),e._v(" "),r("li",[r("p",[e._v("Select the CA file for your connection")])])]),e._v(" "),r("p",[e._v("Optional: Select the "),r("code",[e._v("ta.key")]),e._v(" in the "),r("code",[e._v("TLS-Auth")]),e._v(" section")]),e._v(" "),r("p",[r("img",{attrs:{src:o(439),alt:""}})]),e._v(" "),r("ol",{attrs:{start:"6"}},[r("li",[e._v("Click the Add button next to the Providers field and select the "),r("code",[e._v("PKCS#11")]),e._v(" module for your Nitrokey. Multiple providers can be specified, and for instance we will use "),r("code",[e._v("OpenSC")]),e._v(".")])]),e._v(" "),r("p",[e._v("On macOS, the most common location for modules to be found is in the /usr/lib directory. Please refer to the documentation included with your driver software for the location to use. OpenSC's module can be found at "),r("code",[e._v("/Library/OpenSC/lib/opensc-pkcs11.so")])]),e._v(" "),r("p",[e._v("On Windows, the most common location for libraries is either in "),r("code",[e._v("C:\\Program Files")]),e._v(" or "),r("code",[e._v("C:\\Windows\\System32")]),e._v(". OpenSC libraries are generally located at "),r("code",[e._v("C:\\Program Files\\OpenSC Project\\OpenSC\\pkcs11")]),e._v(". There may be more than one library available here, you can try each one or simply add both.")]),e._v(" "),r("ol",{attrs:{start:"7"}},[r("li",[e._v("Choose a retrieval method from the Retrieval drop down menu")])]),e._v(" "),r("p",[r("img",{attrs:{src:o(440),alt:""}})]),e._v(" "),r("ul",[r("li",[r("p",[e._v("If only one Nitrokey will ever be used on this computer, select "),r("code",[e._v("Use certificate name below")]),e._v(". If the Nitrokey is currently connected to the computer, click the "),r("code",[e._v("Detect")]),e._v(" button for Viscosity to automatically fill in the Name field. Otherwise this field can be completed manually.")])]),e._v(" "),r("li",[r("p",[e._v("If in doubt, or if more than one Nitrokey may be used (i.e. multiple users), then select "),r("code",[e._v("Prompt for certificate name")]),e._v(".")])])]),e._v(" "),r("p",[e._v("If "),r("code",[e._v("Prompt for certificate name")]),e._v(" was selected, Viscosity will automatically detect the required key on the Nitrokey, using the specified PKCS#11 module/s. Select from any of the found devices, or enter the name of the "),r("code",[e._v("serialized id")]),e._v(" to use manually. Again, the user should be prompted for a password/PIN if required.")]),e._v(" "),r("ol",{attrs:{start:"8"}},[r("li",[e._v("Click the Save button and connect from your the main interface")])]),e._v(" "),r("h2",{attrs:{id:"references"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.sparklabs.com/support/kb/article/using-tokens-smartcards-pkcs-11/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Using Tokens/Smartcards (PKCS#11)"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://openvpn.net/community-resources/how-to/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenVPN HOWTO"),r("OutboundLink")],1)])]),e._v(" "),r("h2",{attrs:{id:"notes"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#notes"}},[e._v("#")]),e._v(" Notes")]),e._v(" "),r("ul",[r("li",[e._v("Viscosity is not free, and thus you might run into issues in using the free version.")]),e._v(" "),r("li",[e._v("We are considering the usage of "),r("a",{attrs:{href:"https://client.pritunl.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Pritunl"),r("OutboundLink")],1),e._v(" as a free and open alternative.")])])])}),[],!1,null,null,null);t.default=n.exports}}]);